### Netwrok Layer2
- NAT(network address translation)
  - 내부의 사설 망에서 정보를 인터넷으로 보낼 때, 라우터의 게이트웨이를 통하게 된다.
  - 라우터에는 NAT 테이블이 있어서 어떻게 사설 주소가 공인 주소로 바뀌는지 지정되어 있다. 그래서 IP주소가 변경되어서 전달된다.
  - 이 때, 포트번호도 바꾸어주어야 한다. 같은 포트번호 써도 되는데, 항상 그것으로 쓸 수 있다는 보장이 없다. 
  - ![Alt text](/img/10-0.png)
  - 외부에서 응답이 올 때도, 패킷이 라우터를 통해서 내부로 오게 된다. 이 패킷의 정보 중, Destination port를 보고(아래에서 5001) 라우터는 내부 망으로 전달하게 된다.
  - ![Alt text](/img/10-1.png)
  - 이것이 내부 주소를 재사용 하면서 외부로 나갈 때는 Globally Unique한 주소를 통해 연결할 수 있는 NAT방식이다.
- NAT의 문제점
  - 근데, 포트번호는 원래 프로세스를 찾기 위한 용도인데, 내부 목적지를 찾는데 이용하고 있다. 원래는 IP주소로 찾아야 하는 것.
  - NAT테이블에 예를 들어서, '2.2.2.2:1284'면, 내부의 '10.0.0.2:7777'로 보내라는 방식으로 운영을 하고 있다.
  - 즉, NAT방식을 차용하는 경우 패킷 헤더 정보 중 IP주소, Port번호를 조정하게 된다. 즉, 패킷 헤더 정보를 까는 것.
- DHCP(Dynamic Host Configuration Protocol)
  - 어디에 위치하였든 간에 상관없이 IP주소를 배정받아서 인터넷을 사용가능한 환경을 만들어주는 것.
  - ![Alt text](/img/10-2.png)
  - 브로드캐스트를 통해서 server에 요청한다. 그러면 DHCP도 offer를 보내는데 이를 broadcast로 또 보낸다.
  - Offer가 오면 해당 IP주소를 사용하게 된다. 
